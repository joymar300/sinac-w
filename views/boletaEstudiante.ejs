<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" href="img/COLSAM_Logo.webp" type="image/x-icon">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="css/boleta.css">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lato&display=swap" rel="stylesheet">
    
    <!-- Estilos personalizados para el boletín -->
    <style>
        body {
            font-family: 'Lato', sans-serif;
        }

        .boletin-container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            border: 1px solid #ddd;
            background-color: #f9f9f9;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            position: relative;
        }

        .header img {
            position: absolute;
            top: 0;
            left: 0;
            width: 100px;
        }

        .header h1 {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .header h4 {
            font-weight: normal;
            color: #555;
        }

        h3 {
            margin-top: 20px;
            font-size: 1.5rem;
        }

        .table thead th {
            background-color: #007bff;
            color: #fff;
        }

        .table tbody tr:nth-child(even) {
            background-color: #f2f2f2;
        }

        .footer {
            text-align: center;
            margin-top: 30px;
            font-size: 0.9rem;
            color: #777;
        }

        /* Estilos para la impresión */
        @media print {
            body {
                background-color: #fff;
            }

            .boletin-container {
                box-shadow: none;
                border: none;
            }

            .header img {
                display: block;
            }

            .table thead th {
                background-color: #333 !important;
                color: #fff !important;
            }

            .footer {
                page-break-after: avoid;
            }

            .no-print {
                display: none;
            }
        }
    </style>

</head>
<body>
    <div class="boletin-container">
        <div class="header">
            <img src="img/COLSAM_Logo.webp" alt="Escudo Institucional">
            <h1>Boleta de Calificaciones</h1>
            <h4>Instituto COLSAM</h4>
        </div>

        <% if (place) { %>
            <h3>Estudiante: <%= place.usuNombre %> <%= place.usuApellidoP %> <%= place.usuApellidoM %></h3>
        <% } %>

        <div class="row justify-content-md-center">
            <table class="table table-bordered">
                <thead>
                    <tr>
                        <th scope="col">Materia</th>
                        <th scope="col">Nota del Promedio</th>
                        <th scope="col">Valor del Promedio</th>
                        <th scope="col">Periodo</th>
                    </tr>
                </thead>
                <tbody>
                    <% notas.forEach((notas) => { %>
                    <tr>
                        <th scope="row"><%= notas.matNombre %></th>
                        <td><%= notas.promedio %></td>
                        <td>
                            <% if (notas.promedio <= 3.0 && notas.promedio > 1.0) { %> 
                                Bajo
                            <% } else if (notas.promedio >= 3.1 && notas.promedio <= 3.9) { %> 
                                Básico
                            <% } else if (notas.promedio >= 4.0 && notas.promedio <= 4.9) { %> 
                                Alto
                            <% } else if (notas.promedio > 5.0) { %> 
                                Superior
                            <% } %>
                        </td>
                        
                        <td><%= notas.perNombre %></td>
                    </tr> 
                    <% }) %>
                </tbody>
            </table>

            <div class="footer">
                <h4>Documento generado mediante el sistema SINAC-W del instituto COLSAM</h4>
            </div>

            <!-- Botón de impresión -->
            <div class="text-center mt-4">
                <button class="btn btn-primary no-print" onclick="imprimirBoletin()">
                    <i class="fa fa-print"></i> Imprimir Boletín
                </button>
            </div>

        </div>
    </div>

    <script src="../js/bootstrap.bundle.min.js"></script>

    <!-- Función para imprimir el boletín -->
    <script>
        function imprimirBoletin() {
            window.print();
        }
    </script>
</body>
</html>
