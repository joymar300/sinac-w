<%- include('panelNavBar.ejs'); %>

<form action="generarDes" method="POST" class="container pt-3 col-md-7 col-lg-8">
    <div class="form-control">
      <h3>Generar  desempe침o</h3>
      <!-- <div class="mb-3">
       <label for="" class="form-label pb-3">Cedula de estudiante:</label>
        <input name="cedula" type="text" class="form-control mb-3" id="" required>
      </div> -->
      <div class="mb-3">
        <label for="exampleInputEmail1" class="form-label pb-3" >Seleccione grado a consultar</label>
        <select name="grado" class="form-select" aria-label="Default select example">
          <option selected disabled>Grado</option>
          <% results.forEach((grado) => { %> 
            <option value="<%= grado.idGrado %>"><%= grado.graNombre %></option>
          <% }) %>
        </select>
      </div>
      <label for="dimension" class="form-label mb-3">Seleccione la dimensi칩n:</label>
      <select id="dimensionSelect" name="dimension" class="form-select" aria-label="Default select example">
        <option selected disabled>Dimensi칩n</option>
        <% dimension.forEach((di) => { %>
          <option value="<%= di.id_dim %>"><%= di.claseM %></option>
        <% }) %>
      </select>
  
      <div class="mb-3">
        <label for="materia" class="form-label mb-3">Seleccione la materia:</label>
        <select id="materiaSelect" name="materia" class="form-select" aria-label="Default select example" disabled>
          <option selected disabled>Materia</option>
        </select>
      </div>
  
      <div class="mb-3">
        <label for="exampleInputEmail1" class="form-label">Seleccione el periodo:</label>
        <select name="periodo" class="form-select" aria-label="Default select example">
          <option selected disabled>Periodo</option>
          <option value="1">Periodo 1</option>
          <option value="2">Periodo 2</option>
          <option value="3">Periodo 3</option>
        </select>
      </div>
      <div class="mb-3" >
        <input name="cedula" value="<%= locals.id %>" hidden > </input>
      </div>

      <div class="mb-3">
        <label for="" class="form-label pb-3">comentario:</label>
        <textarea  name="comentario" type="text" class="form-control mb-3" id="" required></textarea>
      </div>
    <button type="submit" class="btn btn-danger mb">enviar</button> 
    </div>
  </form>
</div>

<script>
  // Detectar cambio en el selector de dimensi칩n
  document.getElementById('dimensionSelect').addEventListener('change', function() {
    const dimensionId = this.value;
  
    // Realizar solicitud AJAX
    fetch(`/materias/${dimensionId}`)
      .then(response => response.json())
      .then(data => {
        const materiaSelect = document.getElementById('materiaSelect');
        materiaSelect.innerHTML = '<option selected disabled>Materia</option>'; // Limpiar opciones
        data.forEach(materia => {
          materiaSelect.innerHTML += `<option value="${materia.idMateria}">${materia.matNombre}</option>`;
        });
        materiaSelect.disabled = false; // Habilitar el selector
      })
      .catch(error => console.error('Error:', error));
  });
  </script>